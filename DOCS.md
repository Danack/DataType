
<!---
DOCS.md is generated by running `php generate_docs.php`. 
-->


# DataType

DataType is a library that makes working with named types of data easier. It features:

* Easy to work with those types.
* Clear error messages for users.
* Generating OpenAPI/Swagger specification for those types, so that frontend code can use the exact same specification.


## Example usage

Example code goes here.

## Using without annotations

Although annotations work nicely with this library, some people have strong feelings against using them.

It is possible to use this library without them, it just requires a bit more wiring up:  

Example code goes here.



## Extract rules

The extract rules determine how values are extracted from the source data. As the source data is often composed of just strings, they can convert the value to a int, float, boolean or other type. 

| Type        | Description |
| :---------  | :---------- |
| FixedValue | Extracts a fixed value. Useful for testing. |
| GetArrayOfFloat | Extracts an array of float values, and then applies a list of ProcessPropertyRules<br/>to them. |
| GetArrayOfInt | Extracts an array of int values, and then applies a list of ProcessPropertyRules<br/>to them. |
| GetArrayOfType | Extracts an array of a InputType. |
| GetArrayOfTypeOrNull | Extracts an array of a <DataType|null>. |
| GetBool | Extracts a boolean value.<br/><br/>bool(true) - true<br/>bool(false) - false<br/>string(true) - true<br/>string(false) - false<br/>any other input - error |
| GetBoolOrDefault | Extracts a boolean value, or a default value if the paramter is not set.<br/><br/>bool(true) - true<br/>bool(false) - false<br/>string(true) - true<br/>string(false) - false<br/>any other input - error<br/> |
| GetDatetime | Extracts a DateTime value.<br/><br/>The list of formats allowed can be passed in. The default list of formats is:<br/><br/>DateTime::ATOM,<br/>DateTime::COOKIE,<br/>DateTime::ISO8601,<br/>DateTime::RFC822,<br/>DateTime::RFC850,<br/>DateTime::RFC1036,<br/>DateTime::RFC1123,<br/>DateTime::RFC2822,<br/>DateTime::RFC3339,<br/>DateTime::RFC3339_EXTENDED,<br/>DateTime::RFC7231,<br/>DateTime::RSS,<br/>DateTime::W3C,<br/> |
| GetFloat | Extracts a floating point value. |
| GetFloatOrDefault | Extracts a floating point value or a default value if not set. |
| GetInt | Extracts a int value. |
| GetIntOrDefault | Extracts a int value or a default value if not. |
| GetKernelMatrixOrDefault | Extracts a 2d matrix (aka array of arrays) of floating point values. |
| GetOptionalBool | Extracts a boolean. If a parameter is not set, then the value is null.<br/><br/>bool(true) - true<br/>bool(false) - false<br/>string(true) - true<br/>string(false) - false<br/>any other input - error |
| GetOptionalFloat | Extracts a floating point value or null if the parameter is not available. |
| GetOptionalInt | Extracts a int point value or null if the parameter is not available. |
| GetOptionalString | Extracts a string value or null if the parameter is not available. |
| GetOptionalType | Extracts a DataType value or null if the parameter is not available. |
| GetString | Extracts a string value. |
| GetStringOrDefault | Extracts a string value or a default value if the parameter is not available. |
| GetType | Extracts a DataType value. |


## Process rules 

| Type        | Description |
| :---------  | :---------- |
| AlwaysEndsRule | Rule that ends processing with a set value.<br/><br/>Used for testing. |
| AlwaysErrorsButDoesntHaltRule | Rule that always fails validation but does not stop processing.<br/><br/>This is currently used for testing mostly. |
| AlwaysErrorsRule | Rule that ends processing with an error ValidationResult with the<br/>set error message. |
| CastToBool | Takes input data and converts it to a bool value, or<br/>generates appropriate validationProblems.<br/><br/>bool(true) - true<br/>bool(false) - false<br/>string(true) - true<br/>string(false) - false<br/>any other input - error<br/> |
| CastToFloat | Takes user input and converts it to an float value, or<br/>generates appropriate validationProblems. |
| CastToInt | Takes user input and converts it to an int value, or<br/>generates appropriate validationProblems. |
| CheckOnlyAllowedCharacters | Class CheckOnlyAllowedCharacters<br/><br/>Checks that an input string contains only allowed characters.<br/>Flags used for preg_match are xu<br/> |
| DuplicatesParam |  |
| EarlierThanParam | Checks that one parameter represents an earlier time than another parameter<br/>by a set number of minutes. |
| EarlierThanTime | Checks that one parameter represents an earlier time than<br/>the given time |
| Enum | Checks that the value is one of a known set of values |
| EnumMap | Checks that the value is one of a known set of input values and<br/>then maps it to a different.<br/><br/>e.g. for the enum map of:<br/><br/>[<br/>'rgb' => Imagick::COLORSPACE_RGB,<br/>'hsl' => Imagick::COLORSPACE_HSL,<br/>]<br/><br/>The user could pass in 'hsl' and the resulting value would be whatever the<br/>Imagick::COLORSPACE_HSL constant is.<br/> |
| ImagickIsRgbColor | Validates an RGB or RGBA color string or one of the ImagickIsRgbColor color constant names |
| IsEmail | Class IsEmail |
| IsRgbColor | Class RgbColorRule<br/>Validates an RGB or RGBA color string |
| LaterThanParam | Checks that one parameter represents an later time than another parameter<br/>by a set number of minutes. |
| LaterThanTime | Checks that one parameter represents an earlier time than<br/>the given time |
| MatrixIsOddSized | Check Matrix is odd sized. This is useful as some operation require<br/>a matrix that has a clearly defined centre value. |
| MatrixIsSize | Check Matrix size for either or both rows and column size. |
| MatrixIsSquare | Validates that a matrix is square, i.e. has the same number of rows<br/>and columns. |
| MaxFloatValue | Validates the input value is equal to or less than a particular float value. |
| MaxIntValue | Validates the input value is equal to or less than a particular int value. |
| MaxLength | Checks that the length of a string is at most a certain number of characters. |
| MaximumCount | Validates that there are at most a known count of entries. |
| MinFloatValue | Validates the input value is equal to or greater than a particular float value. |
| MinIntValue | Validates the input value is equal to or greater than a particular int value. |
| MinLength | Checks that the length of a string is at least a certain number of characters. |
| MinimumCount | Validates that there are at least a set count of entries. |
| MultipleEnum | Checks whether a string represent a valid multiple enum string e.g.<br/><br/>Say we have an endpoint for downloading information about content. The users can select<br/>from video, audio, pdf, excel<br/><br/>The string "video,audio" would indicate the user wanted to see content of type video or audio |
| NotNull | Validates that an input or processed value is not null. |
| NullIfEmpty | Convert the value to null if the string is empty or blank, and provides<br/>a final result. |
| Order | <br/>Supports a parameter to specify ordering of results<br/>For example "+name,-date" would be equivalent to ordering<br/>by name ascending, then date descending.<br/><br/>Final value is an array, each element of which contains an array<br/>with the string, and ordering e.g.<br/>[<br/>['name', Ordering::DESC]<br/>] |
| PositiveInt | Class PositiveIntValidator<br/><br/>Checks an input is above zero and a sane int. |
| RangeFloatValue | Validates that a float value is between a range of float values inclusive. |
| RangeIntValue | Validates that a int value is between a range of int values inclusive. |
| RangeStringLength | Validates that the length of a string is between a minimum and maximum. |
| SaneCharacters | <br/>// Any 3 or more combining things. |
| SkipIfNull | Ends processing if a value is null. This is useful to 'short-circuit' nullable<br/>values, e.g. to avoid checking they are between a minimum and maximum value. |
| StartsWithString | Check that a string starts with a particular prefix. |
| Trim | Trims whitespace off the start and end of strings. |
| ValidDate | Checks that input is a valid date of the format 'Y-m-d'. |
| ValidDatetime | Checks that input is a valid datetime of the format \DateTime::RFC3339<br/> |

## Create traits

The library includes several traits to make DataTypes easier to use. The traits fall into two categories, those that return errors, and those that throw exceptions if there is an error.

* CreateFromX will create the DataType or throw a ValidationException if there is a problem with the input data.

* CreateOrErrorFromX will return two values, the created DataType and an empty array if there were no validation problems, or null and an array of ValidationProblems if there were problems.

| Type        | Description |
| :---------  | :---------- |
| CreateFromArray | Creates a DataType from a plain array or throws a ValidationException if there is a<br/>a problem validating the data. |
| CreateFromJson | Creates a DataType from JSON or throws a ValidationException if there is a<br/>a problem validating the data. |
| CreateFromRequest | Creates a DataType from a PSR7 ServerRequest or throws a ValidationException if there is a<br/>a problem validating the data. |
| CreateFromVarMap | Creates a DataType from a VarMap or throws a ValidationException if there is a<br/>a problem validating the data. |
| CreateOrErrorFromArray | Creates a DataType from a plain array.<br/><br/>Returns two values, the DataType created or null and an array of ValidationProblems if there were any. |
| CreateOrErrorFromJson | Creates a DataType from JSON.<br/><br/>Returns two values, the DataType created or null and an array of ValidationProblems if there were any. |
| CreateOrErrorFromRequest | Creates a DataType from a PSR7 ServerRequest.<br/><br/>Returns two values, the DataType created or null and an array of ValidationProblems if there were any. |
| CreateOrErrorFromVarMap | Creates a DataType from a VarMap.<br/><br/>Returns two values, the DataType created or null and an array of ValidationProblems if there were any. |


# Writing your own processing rules

ValidationResult::valueResult
ValidationResult::finalValueResult
ValidationResult::errorResult
ValidationResult::errorButContinueResult


# OpenAPI / Swagger specification generation


Example code goes here.